rules:
  response-allowed-http-code:
    description: >-
      Response code must be in set
      (200,201,202,204,400,401,403,404,405,406,409,415,422,429,500,503).

      Incorrect:

      ```json
      {
        "get": {
          "responses": {
            "499": {}
          }
        }
      }
      ```

      Correct:
      ```json
      {
        "get": {
          "responses": {
            "500": {}
          }
        }
      }
      ```
    severity: 'off'
    given:
      - $..responses.*~
    then:
      function: enumeration
      functionOptions:
        values:
          - '200'
          - '201'
          - '202'
          - '204'
          - '400'
          - '401'
          - '403'
          - '404'
          - '405'
          - '406'
          - '409'
          - '415'
          - '422'
          - '429'
          - '500'
          - '503'
  response-delete-invalid-code:
    description: |-
      DELETE requests should not define `201` or `202` responses.

      Incorrect:
      ```json
      {
        "delete": {
          "responses": {
            "201": {}
          }
        }
      }
      ```

      Correct:
      ```json
      {
        "delete": {
          "responses": {
            "204": {}
          }
        }
      }
      ```
    severity: 'off'
    given:
      - '$.[?( @property == ''delete'' )].responses.*~'
    then:
      function: pattern
      functionOptions:
        notMatch: (201|202)
  response-get-invalid-code:
    description: |-
      GET requests should not define `201`, `202`, `204`, or `409` responses.

      Incorrect:
      ```json
      {
        "get": {
          "responses": {
            "201": {}
          }
        }
      }
      ```

      Correct:
      ```json
      {
        "get": {
          "responses": {
            "200": {}
          }
        }
      }
      ```
    severity: 'off'
    given: '$.[?( @property == ''get'' )].responses.*~'
    then:
      function: pattern
      functionOptions:
        notMatch: (201|202|204|409)
  response-get-must-have-200:
    description: |-
      GET requests must define a `200` response.

      Incorrect:
      ```json
      {
        "get": {
          "responses": {
            "404": {}
          }
        }
      }
      ```

      Correct:
      ```json
      {
        "get": {
          "responses": {
            "200": {},
            "404": {}
          }
        }
      }
      ```
    severity: 'off'
    given:
      - '$.[?( @property == ''get'' )].responses'
    then:
      - field: '200'
        function: truthy
  response-patch-invalid-code:
    description: |-
      PATCH requests should not define `201` or `202` responses.

      Incorrect:
      ```json
      {
        "patch": {
          "responses": {
            "201": {}
          }
        }
      }
      ```

      Correct:
      ```json
      {
        "patch": {
          "responses": {
            "204": {}
          }
        }
      }
      ```
    severity: 'off'
    given:
      - '$.[?( @property == ''patch'' )].responses.*~'
    then:
      function: pattern
      functionOptions:
        notMatch: (201|202)
  response-post-invalid-code:
    description: |-
      POST requests should not define `204` responses.

      Incorrect:
      ```json
      {
        "post": {
          "responses": {
            "204": {}
          }
        }
      }
      ```

      Correct:
      ```json
      {
        "post": {
          "responses": {
            "201": {}
          }
        }
      }
      ```
    severity: 'off'
    given: '$.[?( @property == ''post'' )].responses.*~'
    then:
      function: pattern
      functionOptions:
        notMatch: '204'
  response-post-must-have-201:
    description: |-
      POST requests must define a `201` response.

      Incorrect:
      ```json
      {
        "get": {
          "responses": {
            "422": {}
          }
        }
      }
      ```

      Correct:
      ```json
      {
        "get": {
          "responses": {
            "201": {},
            "422": {}
          }
        }
      }
      ```
    severity: 'off'
    given:
      - '$.[?( @property == ''post'' )].responses'
    then:
      - field: '201'
        function: truthy
  response-put-invalid-code:
    description: |-
      PUT requests should not define `201` responses.

      Incorrect:
      ```json
      {
        "put": {
          "responses": {
            "201": {}
          }
        }
      }
      ```

      Correct:
      ```json
      {
        "put": {
          "responses": {
            "204": {}
          }
        }
      }
      ```
    severity: 'off'
    given: '$.[?( @property == ''put'' )].responses.*~'
    then:
      function: pattern
      functionOptions:
        notMatch: '201'
